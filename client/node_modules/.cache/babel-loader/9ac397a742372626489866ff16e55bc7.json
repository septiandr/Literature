{"ast":null,"code":"var inherits = require('inherits');\n\nvar EventEmitter = require('events').EventEmitter;\n\nmodule.exports = Queue;\nmodule.exports.default = Queue;\n\nfunction Queue(options) {\n  if (!(this instanceof Queue)) {\n    return new Queue(options);\n  }\n\n  EventEmitter.call(this);\n  options = options || {};\n  this.concurrency = options.concurrency || Infinity;\n  this.timeout = options.timeout || 0;\n  this.autostart = options.autostart || false;\n  this.results = options.results || null;\n  this.pending = 0;\n  this.session = 0;\n  this.running = false;\n  this.jobs = [];\n  this.timers = {};\n}\n\ninherits(Queue, EventEmitter);\nvar arrayMethods = ['pop', 'shift', 'indexOf', 'lastIndexOf'];\narrayMethods.forEach(function (method) {\n  Queue.prototype[method] = function () {\n    return Array.prototype[method].apply(this.jobs, arguments);\n  };\n});\n\nQueue.prototype.slice = function (begin, end) {\n  this.jobs = this.jobs.slice(begin, end);\n  return this;\n};\n\nQueue.prototype.reverse = function () {\n  this.jobs.reverse();\n  return this;\n};\n\nvar arrayAddMethods = ['push', 'unshift', 'splice'];\narrayAddMethods.forEach(function (method) {\n  Queue.prototype[method] = function () {\n    var methodResult = Array.prototype[method].apply(this.jobs, arguments);\n\n    if (this.autostart) {\n      this.start();\n    }\n\n    return methodResult;\n  };\n});\nObject.defineProperty(Queue.prototype, 'length', {\n  get: function () {\n    return this.pending + this.jobs.length;\n  }\n});\n\nQueue.prototype.start = function (cb) {\n  if (cb) {\n    callOnErrorOrEnd.call(this, cb);\n  }\n\n  this.running = true;\n\n  if (this.pending >= this.concurrency) {\n    return;\n  }\n\n  if (this.jobs.length === 0) {\n    if (this.pending === 0) {\n      done.call(this);\n    }\n\n    return;\n  }\n\n  var self = this;\n  var job = this.jobs.shift();\n  var once = true;\n  var session = this.session;\n  var timeoutId = null;\n  var didTimeout = false;\n  var resultIndex = null;\n  var timeout = job.hasOwnProperty('timeout') ? job.timeout : this.timeout;\n\n  function next(err, result) {\n    if (once && self.session === session) {\n      once = false;\n      self.pending--;\n\n      if (timeoutId !== null) {\n        delete self.timers[timeoutId];\n        clearTimeout(timeoutId);\n      }\n\n      if (err) {\n        self.emit('error', err, job);\n      } else if (didTimeout === false) {\n        if (resultIndex !== null) {\n          self.results[resultIndex] = Array.prototype.slice.call(arguments, 1);\n        }\n\n        self.emit('success', result, job);\n      }\n\n      if (self.session === session) {\n        if (self.pending === 0 && self.jobs.length === 0) {\n          done.call(self);\n        } else if (self.running) {\n          self.start();\n        }\n      }\n    }\n  }\n\n  if (timeout) {\n    timeoutId = setTimeout(function () {\n      didTimeout = true;\n\n      if (self.listeners('timeout').length > 0) {\n        self.emit('timeout', next, job);\n      } else {\n        next();\n      }\n    }, timeout);\n    this.timers[timeoutId] = timeoutId;\n  }\n\n  if (this.results) {\n    resultIndex = this.results.length;\n    this.results[resultIndex] = null;\n  }\n\n  this.pending++;\n  self.emit('start', job);\n  var promise = job(next);\n\n  if (promise && promise.then && typeof promise.then === 'function') {\n    promise.then(function (result) {\n      return next(null, result);\n    }).catch(function (err) {\n      return next(err || true);\n    });\n  }\n\n  if (this.running && this.jobs.length > 0) {\n    this.start();\n  }\n};\n\nQueue.prototype.stop = function () {\n  this.running = false;\n};\n\nQueue.prototype.end = function (err) {\n  clearTimers.call(this);\n  this.jobs.length = 0;\n  this.pending = 0;\n  done.call(this, err);\n};\n\nfunction clearTimers() {\n  for (var key in this.timers) {\n    var timeoutId = this.timers[key];\n    delete this.timers[key];\n    clearTimeout(timeoutId);\n  }\n}\n\nfunction callOnErrorOrEnd(cb) {\n  var self = this;\n  this.on('error', onerror);\n  this.on('end', onend);\n\n  function onerror(err) {\n    self.end(err);\n  }\n\n  function onend(err) {\n    self.removeListener('error', onerror);\n    self.removeListener('end', onend);\n    cb(err, this.results);\n  }\n}\n\nfunction done(err) {\n  this.session++;\n  this.running = false;\n  this.emit('end', err);\n}","map":{"version":3,"sources":["D:/pelatihan/batch 27/Literature/client/node_modules/queue/index.js"],"names":["inherits","require","EventEmitter","module","exports","Queue","default","options","call","concurrency","Infinity","timeout","autostart","results","pending","session","running","jobs","timers","arrayMethods","forEach","method","prototype","Array","apply","arguments","slice","begin","end","reverse","arrayAddMethods","methodResult","start","Object","defineProperty","get","length","cb","callOnErrorOrEnd","done","self","job","shift","once","timeoutId","didTimeout","resultIndex","hasOwnProperty","next","err","result","clearTimeout","emit","setTimeout","listeners","promise","then","catch","stop","clearTimers","key","on","onerror","onend","removeListener"],"mappings":"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","sourcesContent":["var inherits = require('inherits')\nvar EventEmitter = require('events').EventEmitter\n\nmodule.exports = Queue\nmodule.exports.default = Queue\n\nfunction Queue (options) {\n  if (!(this instanceof Queue)) {\n    return new Queue(options)\n  }\n\n  EventEmitter.call(this)\n  options = options || {}\n  this.concurrency = options.concurrency || Infinity\n  this.timeout = options.timeout || 0\n  this.autostart = options.autostart || false\n  this.results = options.results || null\n  this.pending = 0\n  this.session = 0\n  this.running = false\n  this.jobs = []\n  this.timers = {}\n}\ninherits(Queue, EventEmitter)\n\nvar arrayMethods = [\n  'pop',\n  'shift',\n  'indexOf',\n  'lastIndexOf'\n]\n\narrayMethods.forEach(function (method) {\n  Queue.prototype[method] = function () {\n    return Array.prototype[method].apply(this.jobs, arguments)\n  }\n})\n\nQueue.prototype.slice = function (begin, end) {\n  this.jobs = this.jobs.slice(begin, end)\n  return this\n}\n\nQueue.prototype.reverse = function () {\n  this.jobs.reverse()\n  return this\n}\n\nvar arrayAddMethods = [\n  'push',\n  'unshift',\n  'splice'\n]\n\narrayAddMethods.forEach(function (method) {\n  Queue.prototype[method] = function () {\n    var methodResult = Array.prototype[method].apply(this.jobs, arguments)\n    if (this.autostart) {\n      this.start()\n    }\n    return methodResult\n  }\n})\n\nObject.defineProperty(Queue.prototype, 'length', {\n  get: function () {\n    return this.pending + this.jobs.length\n  }\n})\n\nQueue.prototype.start = function (cb) {\n  if (cb) {\n    callOnErrorOrEnd.call(this, cb)\n  }\n\n  this.running = true\n\n  if (this.pending >= this.concurrency) {\n    return\n  }\n\n  if (this.jobs.length === 0) {\n    if (this.pending === 0) {\n      done.call(this)\n    }\n    return\n  }\n\n  var self = this\n  var job = this.jobs.shift()\n  var once = true\n  var session = this.session\n  var timeoutId = null\n  var didTimeout = false\n  var resultIndex = null\n  var timeout = job.hasOwnProperty('timeout') ? job.timeout : this.timeout\n\n  function next (err, result) {\n    if (once && self.session === session) {\n      once = false\n      self.pending--\n      if (timeoutId !== null) {\n        delete self.timers[timeoutId]\n        clearTimeout(timeoutId)\n      }\n\n      if (err) {\n        self.emit('error', err, job)\n      } else if (didTimeout === false) {\n        if (resultIndex !== null) {\n          self.results[resultIndex] = Array.prototype.slice.call(arguments, 1)\n        }\n        self.emit('success', result, job)\n      }\n\n      if (self.session === session) {\n        if (self.pending === 0 && self.jobs.length === 0) {\n          done.call(self)\n        } else if (self.running) {\n          self.start()\n        }\n      }\n    }\n  }\n\n  if (timeout) {\n    timeoutId = setTimeout(function () {\n      didTimeout = true\n      if (self.listeners('timeout').length > 0) {\n        self.emit('timeout', next, job)\n      } else {\n        next()\n      }\n    }, timeout)\n    this.timers[timeoutId] = timeoutId\n  }\n\n  if (this.results) {\n    resultIndex = this.results.length\n    this.results[resultIndex] = null\n  }\n\n  this.pending++\n  self.emit('start', job)\n  var promise = job(next)\n  if (promise && promise.then && typeof promise.then === 'function') {\n    promise.then(function (result) {\n      return next(null, result)\n    }).catch(function (err) {\n      return next(err || true)\n    })\n  }\n\n  if (this.running && this.jobs.length > 0) {\n    this.start()\n  }\n}\n\nQueue.prototype.stop = function () {\n  this.running = false\n}\n\nQueue.prototype.end = function (err) {\n  clearTimers.call(this)\n  this.jobs.length = 0\n  this.pending = 0\n  done.call(this, err)\n}\n\nfunction clearTimers () {\n  for (var key in this.timers) {\n    var timeoutId = this.timers[key]\n    delete this.timers[key]\n    clearTimeout(timeoutId)\n  }\n}\n\nfunction callOnErrorOrEnd (cb) {\n  var self = this\n  this.on('error', onerror)\n  this.on('end', onend)\n\n  function onerror (err) { self.end(err) }\n  function onend (err) {\n    self.removeListener('error', onerror)\n    self.removeListener('end', onend)\n    cb(err, this.results)\n  }\n}\n\nfunction done (err) {\n  this.session++\n  this.running = false\n  this.emit('end', err)\n}\n"]},"metadata":{},"sourceType":"script"}